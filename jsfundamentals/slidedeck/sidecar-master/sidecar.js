/*
 * Copyright (C) 2013 digital-telepathy  (email : support@digital-telepathy.com)
 * 
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 * 
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */
var Sidecar;(function($,window,undefined){window.Sidecar=function(contentElem,opts){this.elems={};this.options={};this.isOpen=false;this.ns="sidecar";this.elems.sidecarContent=$(contentElem);this.__construct(opts)};window.Sidecar.prototype.__construct=function(opts){var self=this;this.options.openDelay=250;this.options.sidecarPosition='left';this.options.shadow=true;this.elems.body=$('body');this.elems.sidecarWrapper=$('#sidecar-wrapper');if(this.elems.sidecarWrapper.length==0){self.elems.sidecarWrapper=document.createElement('div');self.elems.sidecarWrapper.id='sidecar-wrapper';while(document.body.firstChild){self.elems.sidecarWrapper.appendChild(document.body.firstChild)};document.body.appendChild(self.elems.sidecarWrapper)};this.options.android=false;var ua=navigator.userAgent.toLowerCase();if(ua.indexOf("android")>-1){this.options.android=true;this.elems.body.addClass(this.ns+'-no-drawer-transition');this.elems.body.addClass(this.ns+'-no-fixed-position')};if(typeof(opts)!="undefined"){for(var key in opts){self.options[key]=opts[key]}};this.elems.body.addClass('sidecar-'+self.options.sidecarPosition);if(ua.match(/android|ipad|iphone/))this.elems.body.removeClass('sidecar-left');if(this.options.width!=undefined){var css="",head=document.head||document.getElementsByTagName('head')[0],style=document.createElement('style');style.type='text/css';css+="body.sidecar-open-drawer #sidecar-wrapper,body.sidecar-left div#sidecar .sidecar-inner{left:-"+self.options.width+";}\n";css+="body.sidecar-left.sidecar-open-drawer #sidecar-wrapper {right:-"+self.options.width+";}\n";css+="body.sidecar-open-drawer div#sidecar,body div#sidecar .sidecar-inner{width:"+self.options.width+"}\n";css+="body.sidecar-open-drawer #sidecar-open,body.sidecar-open-drawer #sidecar-open:link,body.sidecar-open-drawer #sidecar-open:visited,body.sidecar-open-drawer #sidecar-close,body.sidecar-open-drawer #sidecar-close:link,body.sidecar-open-drawer #sidecar-close:visited{right:"+self.options.width+"}\n";css+="body.sidecar-left.sidecar-open-drawer #sidecar-open,body.sidecar-left.sidecar-open-drawer #sidecar-open:link,body.sidecar-left.sidecar-open-drawer #sidecar-open:visited,body.sidecar-left.sidecar-open-drawer #sidecar-close,body.sidecar-left.sidecar-open-drawer #sidecar-close:link,body.sidecar-left.sidecar-open-drawer #sidecar-close:visited{left:"+self.options.width+"}\n";if(style.styleSheet){style.styleSheet.cssText=css}else{style.appendChild(document.createTextNode(css))};head.appendChild(style)}this._addDrawer();this._bindEvents()};window.Sidecar.prototype._addDrawer=function(){this.elems.drawer=$('<div id="'+this.ns+'"></div>').appendTo(this.elems.body);this.elems.drawerInner=$('<div class="'+this.ns+'-inner"></div>').appendTo(this.elems.drawer);if(!this.options.shadow){this.elems.drawerInner.addClass(this.ns+'-no-shadow')};this.elems.sidecarContent.appendTo(this.elems.drawerInner);this.elems.drawerInner.css({height:$(document).height()});this._addOpenButton();this._addCloseButton()};window.Sidecar.prototype._setTabPosition=function(button){var self=this;if(this.options.tabPosition!=undefined){if(self.options.tabPosition.indexOf('%')!==-1){var height=button.outerHeight(true);button.css({marginTop:-height/2})};button.css({top:self.options.tabPosition})}};window.Sidecar.prototype._addOpenButton=function(){this.elems.open=$('<a id="'+this.ns+'-open" class="icon-bars" href="#open"><div class="horiz bar"></div><div class="vert bar"></div></a>').appendTo(this.elems.body);this._setTabPosition(this.elems.open)};window.Sidecar.prototype._addCloseButton=function(){this.elems.close=$('<a id="'+this.ns+'-close" href="#close"><div class="horiz bar"></div></a>').appendTo(this.elems.body);this._setTabPosition(this.elems.close)};window.Sidecar.prototype._bindEvents=function(){var self=this;this.elems.open.on('click',function(event){event.preventDefault();self.open()});this.elems.close.on('click',function(event){event.preventDefault();self.close()})};window.Sidecar.prototype.close=function(){this.elems.body.removeClass(this.ns+'-open-drawer')};window.Sidecar.prototype.open=function(){this.elems.body.addClass(this.ns+'-open-drawer')}})(jQuery,window,null);